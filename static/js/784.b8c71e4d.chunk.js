"use strict";(self.webpackChunkreact_widget_template=self.webpackChunkreact_widget_template||[]).push([[784],{3215:(e,t,r)=>{r.d(t,{A:()=>u});var n=r(5043),s=r(174),o=r(2725),a=r(8012),i=r(3277),l=r(7726),c=r(6713),d=r(579);const u=()=>{const{handleDrop:e}=(0,a.A)(),{showSuccessToast:t,showErrorToast:r}=(0,o.A)(),[u,p]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{if(!window.widget)return;console.trace("[WidgetLifecycle] \ud83d\udd04 `onRefresh` was called from:"),window.widget.addEvent("onRefresh",(async()=>{var n,o;const a=(new Error).stack.split("\n"),c=sessionStorage.getItem("userClickedRefresh");if((e=>e.some((e=>e.includes("UWA_Frame_Alone.js")||e.includes("bundle-min.js"))))(a)&&!c)return void console.warn("[WidgetLifecycle] \u26d4 Auto-refresh detected. Ignoring unwanted `onRefresh`.");sessionStorage.removeItem("userClickedRefresh"),p(!0);const d=l.A.getState().droppedObject.droppedObjectData.initialDraggedData;if(null===d||void 0===d||null===(n=d.data)||void 0===n||null===(o=n.items)||void 0===o||!o.length)return console.error("[WidgetLifecycle] \u26a0\ufe0f `initialDraggedData` is missing or invalid:",d),void p(!1);try{await(0,s.M)(d.data.items,e)}catch(u){console.error("[WidgetLifecycle] \u274c Error during refresh:",u),r(i.H6)}finally{p(!1),t(i._l)}}))}),[]),u?(0,d.jsx)(c.A,{}):null}},6713:(e,t,r)=>{r.d(t,{A:()=>s});r(5043);var n=r(579);const s=()=>(0,n.jsx)("div",{className:"loader-container",children:(0,n.jsx)("div",{className:"loader"})})},8012:(e,t,r)=>{r.d(t,{A:()=>d});var n=r(5043),s=r(3003),o=r(5645),a=r(360),i=r(314),l=r(2725),c=r(3277);const d=()=>{const{showErrorToast:e}=(0,l.A)(),{fetchRevisionsAndParents:t}=(0,a.A)(),r=(0,s.wA)(),d=(0,s.d4)((e=>e.droppedObject.isDropped)),u=(0,s.d4)((e=>e.droppedObject.loading)),p=(0,n.useCallback)((async n=>{try{const l=await(0,i.Sj)({dataItems:n});if(l.success){var s,a;const e=l.data.cardData.relativePath,[i]=await Promise.all([t(null===(s=n[0])||void 0===s?void 0:s.objectId,null===(a=n[0])||void 0===a?void 0:a.objectType,e)]);r((0,o.um)({cardData:l.data.cardData,parentDetails:i||[]})),console.log("[fetchObjectDetails] \u2705 Redux store updated.")}else e(c.wX)}catch(l){console.error("[FetchObjectDetails] Error fetching details:",l),e(c.wX)}finally{console.log("[fetchObjectDetails] \ud83c\udfc1 Ensuring loading is reset."),r((0,o.r1)(!1))}}),[r,t,e]),h=(0,n.useCallback)((async t=>{console.log("[handleDrop] handleDrop called with dataItems:",t);try{if(t&&t.length>0){var n;const s=null===(n=t[0])||void 0===n?void 0:n.objectType;if(!["VPMReference","Document","Raw_Material"].includes(s))return void e(c.Zo);r((0,o.Rr)(!0)),console.log("[handleDrop] \ud83d\udd04 Force setting `loading = true`..."),r((0,o.r1)(!1)),setTimeout((()=>r((0,o.r1)(!0))),0),await p(t)}else console.warn("[handleDrop] No data items to process.")}catch(s){console.error("[Drop] Error in handleDrop:",s),r((0,o.r1)(!1)),console.log("[handleDrop] Error in handleDrop, setting loading to false"),e(c.nz)}}),[p,e]);return{initializeDroppableArea:(0,n.useCallback)((()=>{d?console.log("[initializeDroppableArea] \u23f3 isDropped is already true. Skipping reset."):(console.log("[initializeDroppableArea] \ud83d\ude80 Resetting isDropped to false..."),r((0,o.Rr)(!1)));const t=setInterval((()=>{const n=document.querySelector(".droppable-container");n&&(clearInterval(t),(0,i.pn)(n,h,r,e))}),100);return()=>clearInterval(t)}),[h,r]),loading:u,handleDrop:h}}},360:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(2725),s=r(3862),o=r(3277);const a=()=>{const{showSuccessToast:e,showErrorToast:t}=(0,n.A)();return{fetchRevisionsAndParents:async(e,t,r)=>{if(!r)return void console.error("[Fetch Revisions] \u274c Missing relative path.");try{const n=await s.A.post("/revFloat/getParents",{data:{id:e,type:t,relativePath:r}});if(200===n.status){return n.data}throw new Error("[Fetch Revisions] HTTP error! status: ".concat(n.status))}catch(n){return console.error("[Fetch Revisions] \u274c Error occurred:",n),null}},replaceRevisions:async(r,n,a)=>{try{const t=await s.A.post("/revFloat/floatRevisions",{SelectedParents:r,DroppedData:n,userEmail:a});if(200===t.status)return console.log("Replacement successful:",t.data),e(o.hG),{success:!0};throw new Error("[Replacement API] HTTP error! status: ".concat(t.status))}catch(i){return console.error("Error during replacement:",i),t(o.mK),{success:!1,error:i.message}}}}}},2725:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(9379),s=r(3986),o=r(7488);const a=["message","type","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","pauseOnFocusLoss","draggable","theme","transition"],i=()=>{const e=e=>{let{message:t,type:r="default",position:i="top-right",autoClose:l=2e3,hideProgressBar:c=!1,closeOnClick:d=!0,pauseOnHover:u=!1,pauseOnFocusLoss:p=!1,draggable:h=!0,theme:g="light",transition:f=o.br}=e,m=(0,s.A)(e,a);(o.oR[r]||o.oR)(t,(0,n.A)({position:i,autoClose:l,hideProgressBar:c,closeOnClick:d,pauseOnHover:u,draggable:h,theme:g,transition:f},m))};return{showToast:e,showSuccessToast:function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e((0,n.A)({message:t,type:"success"},r))},showErrorToast:function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e((0,n.A)({message:t,type:"error"},r))},showInfoToast:function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e((0,n.A)({message:t,type:"info"},r))},showWarningToast:function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e((0,n.A)({message:t,type:"warn"},r))}}}},7059:(e,t,r)=>{r.d(t,{r:()=>P,A:()=>S});var n=r(7055),s=r(5043),o=r(3969),a=r(4799),i=r(5974),l=r(13),c=r(1449),d=r(2097),u=r(4842),p=r(3759),h=r(579);const g=e=>{let{parentParts:t,sourceOrg:r,selectedItems:n}=e;return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)(i.A,{spacing:3,children:[(0,h.jsxs)(o.A,{children:[(0,h.jsx)(u.A,{variant:"subtitle1",sx:{fontWeight:"medium"},children:"Parent item(s) to Assign:"}),(0,h.jsx)(u.A,{variant:"body1",sx:{marginBottom:2,whiteSpace:"pre-line"},children:t})]}),(0,h.jsxs)(o.A,{children:[(0,h.jsx)(u.A,{variant:"subtitle1",sx:{fontWeight:"medium"},children:"Source Organization:"}),(0,h.jsx)(u.A,{variant:"body1",sx:{marginBottom:2},children:r})]}),(0,h.jsxs)(o.A,{children:[(0,h.jsx)(u.A,{variant:"subtitle1",sx:{fontWeight:"medium"},children:"Items to be Processed:"}),n.length>0?(0,h.jsx)(o.A,{sx:{display:"flex",flexWrap:"wrap",gap:1,marginTop:1},children:n.map((e=>(0,h.jsx)(p.A,{label:e,color:"primary"},e)))}):(0,h.jsx)(u.A,{variant:"body2",color:"textSecondary",children:"No items selected."})]})]})})};var f=r(3546),m=r(3605),x=r(6020);const v=e=>{let{message:t}=e;return(0,h.jsxs)(a.A,{sx:{padding:4,width:"100%",maxWidth:600,borderRadius:4,boxShadow:3,textAlign:"center",backgroundColor:"#f5f5f5",border:"2px solid #3f51b5"},children:[(0,h.jsx)(o.A,{sx:{marginBottom:2},children:(0,h.jsx)(u.A,{variant:"h6",color:"primary",fontWeight:"bold",children:t})}),(0,h.jsx)(x.A,{color:"primary"})]})};function w(e){let{children:t,isOpen:r,onSubmit:n,onCancel:o,disabled:a,title:l}=e;const c=(0,s.useRef)(null);return(0,s.useEffect)((()=>{const e=new AbortController,{signal:t}=e;return r&&window.addEventListener("mousedown",(function(e){c.current&&!c.current.contains(e.target)&&o()}),{signal:t}),()=>e.abort()}),[r,o]),(0,h.jsx)("div",{className:"flex justify-center items-center",children:(0,h.jsx)(f.N,{children:r&&(0,h.jsx)(m.P.div,{className:"fixed inset-0 flex items-center justify-center backdrop-blur-xs bg-black/30 z-10",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,h.jsxs)(m.P.div,{ref:c,className:"bg-white rounded-2xl p-6 shadow-xl min-w-[70%] md:min-w-[40%] max-w-[60%]",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},children:[(0,h.jsx)(u.A,{variant:"h5",sx:{fontWeight:"bold",textAlign:"center"},children:l}),a&&(0,h.jsx)("div",{className:"w-full flex justify-center py-4",children:(0,h.jsx)(v,{message:"Searching for parts..."})}),t,(0,h.jsxs)(i.A,{direction:"row",spacing:2,justifyContent:"flex-end",className:"pt-4",children:[(0,h.jsx)(d.A,{variant:"contained",color:"primary",onClick:n,disabled:a,children:"Confirm"}),(0,h.jsx)(d.A,{variant:"outlined",color:"secondary",onClick:o,disabled:a,children:"Cancel"})]})]})})})})}var b=r(3774),A=r(7122);const j=(0,b.eU)(!1);var y=r(9522),D=r(3768);var C=r(5906);const O=e=>{var t,r;let{selectedItems:s,onChange:i,disabled:c}=e;const d=e=>{!e||null!==s&&void 0!==s&&s.includes(e)||i([...s,e])},{data:g}=(0,y.Z6)({}),{data:f}=(0,y.sQ)({});return(0,h.jsxs)(o.A,{sx:{width:"100%",display:"flex",flexDirection:"column",gap:2},children:[(0,h.jsx)(C.A,{options:null!==(t=null===g||void 0===g?void 0:g.data)&&void 0!==t?t:[],onChange:(e,t)=>d(t),renderInput:e=>(0,h.jsx)(l.A,(0,n.A)((0,n.A)({},e),{},{label:"RDO Name (will appear in Selected Plants)",fullWidth:!0,variant:"outlined",disabled:c}))}),(0,h.jsx)(C.A,{options:null!==(r=null===f||void 0===f?void 0:f.data)&&void 0!==r?r:[],onChange:(e,t)=>d(t),renderInput:e=>(0,h.jsx)(l.A,(0,n.A)((0,n.A)({},e),{},{label:"Destination JDI Orgs (will appear in Selected Plants)",fullWidth:!0,variant:"outlined",disabled:c}))}),(0,h.jsx)(u.A,{variant:"caption",color:"textSecondary",children:"Selections from both fields will appear below."}),(0,h.jsxs)(a.A,{sx:{padding:2,borderRadius:2,boxShadow:2,maxHeight:200,overflowY:"auto"},children:[(0,h.jsx)(u.A,{variant:"subtitle1",sx:{fontWeight:"bold",marginBottom:2},children:"Selected Plants"}),(0,h.jsx)(o.A,{sx:{display:"flex",flexWrap:"wrap",gap:1,minHeight:20},children:s.map((e=>(0,h.jsx)(p.A,{label:e,onDelete:()=>{return t=e,void i(null===s||void 0===s?void 0:s.filter((e=>e!==t)));var t},color:"primary"},e)))})]})]})},P=()=>{const[e,t]=(0,s.useState)({}),[r,u]=(0,s.useState)({parentParts:"",sourceOrg:"",plants:[]}),p=(e,t)=>{u((r=>(0,n.A)((0,n.A)({},r),{},{[e]:t})))},{isOpen:f,setIsOpen:m}=(()=>{const[e,t]=(0,A.fp)(j);return{isOpen:e,setIsOpen:t}})(),x=()=>m(!1),[v,{isLoading:b}]=(0,y.nh)();return(0,h.jsxs)(o.A,{sx:{minHeight:"calc(100vh - 65px)",backgroundColor:"#eef2f6"},children:[(0,h.jsx)(w,{isOpen:f,title:"Confirm Your Submission",onSubmit:async()=>{const{data:e,error:t}=await v({parentPart:r.parentParts,sourceOrg:r.sourceOrg,plants:r.plants});t&&D.Ay.error(function(e){if(e&&"object"===typeof e&&"data"in e){const t=e;if("object"===typeof t.data&&null!==t.data&&"message"in t.data)return t.data.message}return"object"===typeof e&&null!==e&&"message"in e?(console.error(e),e.message):"An unexpected error occurred."}(t)),m(!1),D.Ay.success(e.message)},onCancel:x,disabled:b,children:(0,h.jsx)(g,{parentParts:r.parentParts,sourceOrg:r.sourceOrg,selectedItems:r.plants})}),(0,h.jsxs)(o.A,{sx:{padding:4,display:"flex",flexDirection:"column",alignItems:"center",gap:4,minHeight:"calc(100vh - 200px)"},children:[(0,h.jsx)(a.A,{sx:{padding:4,width:"100%",maxWidth:600,borderRadius:4,boxShadow:3},children:(0,h.jsx)("form",{onSubmit:e=>{e.preventDefault();const n={};r.parentParts.trim()||(n.parentParts="Parent Part is required"),r.sourceOrg.trim()||(n.sourceOrg="Source org is required"),r.plants.length||(n.plants="Select either RDO Name or Destination JDI Org"),t(n),0===Object.keys(n).length&&m(!0)},children:(0,h.jsxs)(i.A,{spacing:3,children:[(0,h.jsx)(l.A,{label:"Parent item(s) to Assign",variant:"outlined",value:r.parentParts,onChange:e=>p("parentParts",e.target.value),error:!!e.parentParts,helperText:e.parentParts,fullWidth:!0}),(0,h.jsx)(l.A,{label:"Source Organization",variant:"outlined",value:r.sourceOrg,onChange:e=>p("sourceOrg",e.target.value),error:!!e.sourceOrg,helperText:e.sourceOrg,fullWidth:!0}),(0,h.jsx)(O,{selectedItems:r.plants,onChange:e=>p("plants",e),disabled:!1}),e.plants&&(0,h.jsx)(c.A,{severity:"error",children:e.plants}),(0,h.jsxs)(i.A,{direction:"row",spacing:2,justifyContent:"flex-end",children:[(0,h.jsx)(d.A,{type:"submit",variant:"contained",color:"primary",children:"Submit"}),(0,h.jsx)(d.A,{type:"button",variant:"outlined",color:"secondary",onClick:x,children:"Cancel"})]})]})})}),!1]})]})},S=P},5784:(e,t,r)=>{r.r(t),r.d(t,{default:()=>w});var n=r(5043),s=r(4391),o=r(1240),a=r(3248),i=r(3003),l=r(9367),c=r(3768),d=r(7488),u=r(7726),p=r(579);const h=e=>{let{children:t}=e;const r=new o.E;return(0,p.jsx)(l.vd,{children:(0,p.jsx)(i.Kq,{store:u.A,children:(0,p.jsx)(a.Ht,{client:r,children:(0,p.jsxs)(n.Suspense,{fallback:(0,p.jsx)("h1",{children:"loading................"}),children:[(0,p.jsx)(c.l$,{position:"top-center",reverseOrder:!1}),(0,p.jsx)(d.N9,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!1,pauseOnFocusLoss:!1,draggable:!0,theme:"light",transition:d.br}),t]})})})})};var g=r(3215);r(8885);let f=null;function m(e){if(function(){if(window.parent&&window.parent.document){let e=window.parent.document.createElement("script");e.textContent='\n      function listenForRefreshClicks() {\n        // console.log("\ud83c\udf0d [Parent] Listening for manual refresh clicks...");\n  \n        document.body.addEventListener("click", function (event) {\n          let refreshButton = event.target.closest("#refresh"); // Check if refresh was clicked\n  \n          if (refreshButton) {\n            // console.log("\u2705 [Parent] User clicked Refresh!");\n            sessionStorage.setItem("userClickedRefresh", "true"); // Store flag\n            // console.log("Stored Flag:", sessionStorage.getItem("userClickedRefresh"));\n          }\n        }, true);\n      }\n  \n      // \u2705 Ensure event listener is added even if DOM is already loaded\n      if (document.readyState === "loading") {\n        document.addEventListener("DOMContentLoaded", listenForRefreshClicks);\n      } else {\n        listenForRefreshClicks();\n      }\n    ',window.parent.document.body.appendChild(e)}else console.warn("\u26a0\ufe0f [index.js] Unable to inject script\u2014parent window not accessible.")}(),window.widget){let t=!1;window.widget.addEvent("onLoad",(()=>{t?console.warn("\u23f3 onLoad was already executed. Ignoring duplicate trigger."):(t=!0,function(e){var t;requirejs(["DS/PlatformAPI/PlatformAPI"],(e=>{window.PlatformAPI=e}));const r=window.widget;let n=(null===r||void 0===r||null===(t=r.body)||void 0===t?void 0:t.querySelector("#root"))||document.getElementById("root");n||(n=document.createElement("div"),n.id="root",((null===r||void 0===r?void 0:r.body)||document.body).appendChild(n)),f=f||(0,s.createRoot)(n),f.render((0,p.jsxs)(h,{children:[(0,p.jsx)(g.A,{}),e]}))}(e))}))}else console.error("\u274c Widget not detected! onLoad cannot be registered.");return e}var x=r(7059),v=r(8012);const w=()=>((()=>{const{initializeDroppableArea:e}=(0,v.A)(),t=(0,n.useRef)(!1),r=(0,n.useCallback)((()=>{t.current||(e(),t.current=!0)}),[e]),s=(0,i.d4)((e=>e.droppedObject.isDropped),i.bN);(0,n.useEffect)((()=>{r(),console.info("[RevisionFloat] State Changes:",{isDropped:s})}),[r,s])})(),m((0,p.jsx)(x.r,{})))},174:(e,t,r)=>{r.d(t,{M:()=>n});const n=async(e,t)=>{if(console.log("[refreshWidgetData] called with dataItems:",e),e&&0!==e.length)try{if("function"!==typeof t)throw new Error("[Refresh] handleDrop is not a function.");await t(e)}catch(r){console.error("[Refresh] Error during handleDrop execution:",r)}else console.warn("[Refresh] No dropped data available to refresh.")}}}]);
//# sourceMappingURL=784.b8c71e4d.chunk.js.map