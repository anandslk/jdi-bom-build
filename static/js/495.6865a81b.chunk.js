"use strict";(self.webpackChunkreact_widget_template=self.webpackChunkreact_widget_template||[]).push([[495],{1358:(e,t,s)=>{s.d(t,{A:()=>a});s(5043),s(8012),s(4119);var r=s(3637),n=s(1397),i=s(4675),o=s(579);const a=e=>{let{handleDrop:t}=e;const{performSearch:s}=(0,i.A)();return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"droppable-container mt-4",children:[(0,o.jsx)(r.A,{style:{width:"90px",height:"90px"},src:"https://thewhitechamaleon.github.io/testrapp/images/drag.png",alt:"Data Collect",className:"search-icon"}),(0,o.jsx)("span",{className:"drag-and-drop-text",children:"Drag and Drop"}),(0,o.jsxs)("div",{className:"divider-container",children:[(0,o.jsx)("hr",{className:"divider"}),(0,o.jsx)("span",{className:"divider-text",children:"or"}),(0,o.jsx)("hr",{className:"divider"})]}),(0,o.jsx)(n.A,{onSearch:e=>{s(e,{title:"Search",role:"",mode:"furtive",default_with_precond:!0,precond:'flattenedtaxonomies:"types/VPMReference" OR flattenedtaxonomies:"types/Raw_Material" OR flattenedtaxonomies:"types/Document"',show_precond:!1,multiSel:!1,idcard_activated:!1,select_result_max_idcard:!1,itemViewClickHandler:"",search_delegation:"3dsearch"},(async e=>{e&&e.length>0&&e[0].id?await t([{objectId:e[0].id,objectType:e[0]["ds6w:type_value"]}]):console.warn("No objectId found in selected objects")}))}})]})})}},6713:(e,t,s)=>{s.d(t,{A:()=>n});s(5043);var r=s(579);const n=()=>(0,r.jsx)("div",{className:"loader-container",children:(0,r.jsx)("div",{className:"loader"})})},1397:(e,t,s)=>{s.d(t,{A:()=>d});var r=s(5043),n=s(1666),i=s(2691),o=s(4282),a=s(3910),l=s(7929),c=s(579);const d=e=>{let{onSearch:t,disabled:s}=e;const[d,h]=(0,r.useState)(""),u=(0,r.useRef)(null);return(0,c.jsxs)("div",{className:"search-content-container d-flex align-items-center",children:[(0,c.jsx)(a.g,{icon:l.$UM,onClick:()=>{d.trim()&&t(d)},className:"search-icon"}),(0,c.jsx)("span",{className:"ms-4 drag-and-drop-text flex-grow-1",children:(0,c.jsxs)(n.A,{children:[(0,c.jsx)(i.A.Control,{type:"text",ref:u,value:d,onChange:e=>{const t=e.target.value;h(t)},onKeyDown:e=>{"Enter"===e.key&&d.trim()&&t(d)},placeholder:"Search...",disabled:s}),d&&(0,c.jsx)(o.A,{variant:"btn-link",onClick:()=>{h(""),u.current.focus()},className:"clear-button",children:"\u2716"})]})})]})}},8012:(e,t,s)=>{s.d(t,{A:()=>c});var r=s(5043),n=s(3003),i=s(5645),o=s(360),a=(s(314),s(2725)),l=s(3277);const c=()=>{const{showErrorToast:e}=(0,a.A)(),{fetchRevisionsAndParents:t}=(0,o.A)(),s=(0,n.wA)();(0,n.d4)((e=>e.droppedObject.isDropped));return{initializeDroppableArea:()=>{},loading:(0,n.d4)((e=>e.droppedObject.loading)),handleDrop:(0,r.useCallback)((async t=>{console.log("[handleDrop] handleDrop called with dataItems:",t);try{if(t&&t.length>0){var r;const n=null===(r=t[0])||void 0===r?void 0:r.objectType;if(!["VPMReference","Document","Raw_Material"].includes(n))return void e(l.Zo);s((0,i.Rr)(!0)),console.log("[handleDrop] \ud83d\udd04 Force setting `loading = true`..."),s((0,i.r1)(!1)),setTimeout((()=>s((0,i.r1)(!0))),0)}else console.warn("[handleDrop] No data items to process.")}catch(n){console.error("[Drop] Error in handleDrop:",n),s((0,i.r1)(!1)),console.log("[handleDrop] Error in handleDrop, setting loading to false"),e(l.nz)}}),[e])}}},4675:(e,t,s)=>{s.d(t,{A:()=>o});var r=s(7055),n=s(5043),i=s(6047);const o=()=>{const[e,t]=(0,n.useState)(null),[s,o]=(0,n.useState)(null);(0,n.useEffect)((()=>{(async()=>{try{const e=await(0,i.qZ)();o(e)}catch(e){console.error("[useInterComSearch] Error initializing InterCom:",e)}})()}),[]),(0,n.useEffect)((()=>()=>{e&&e.disconnect()}),[e]);return{performSearch:(0,n.useCallback)(((e,n,i)=>{var o;if(!s)return void console.warn("[useInterComSearch] InterCom is not loaded yet.");const a="socket"+(new Date).toISOString().replace(/[-:]/g,""),l=new s.Socket(a,{dispatchRetryInternal:0});l.subscribeServer("SearchComServer"),t(l),console.log("[useInterComSearch] performSearch called with:",e,n);const c=null===(o=window.widget)||void 0===o?void 0:o.id,d=(0,r.A)((0,r.A)({},n),{},{widget_id:c,app_socket_id:a,default_search_criteria:e});console.log("[useInterComSearch] Dispatching RegisterContext event with:",d),l.dispatchEvent("RegisterContext",d),l.dispatchEvent("InContextSearch",d);console.log("[useInterComSearch] Adding listener for Selected_Objects_search"),l.addListener("Selected_Objects_search",(e=>{console.log("[useInterComSearch] Search results received:",e),i&&i(e)}))}),[s])}}},360:(e,t,s)=>{s.d(t,{A:()=>o});var r=s(2725),n=s(3862),i=s(3277);const o=()=>{const{showSuccessToast:e,showErrorToast:t}=(0,r.A)();return{fetchRevisionsAndParents:async(e,t,s)=>{if(!s)return void console.error("[Fetch Revisions] \u274c Missing relative path.");try{const r=await n.A.post("/revFloat/getParents",{data:{id:e,type:t,relativePath:s}});if(200===r.status){return r.data}throw new Error("[Fetch Revisions] HTTP error! status: ".concat(r.status))}catch(r){return console.error("[Fetch Revisions] \u274c Error occurred:",r),null}},replaceRevisions:async(s,r,o)=>{try{const t=await n.A.post("/revFloat/floatRevisions",{SelectedParents:s,DroppedData:r,userEmail:o});if(200===t.status)return console.log("Replacement successful:",t.data),e(i.hG),{success:!0};throw new Error("[Replacement API] HTTP error! status: ".concat(t.status))}catch(a){return console.error("Error during replacement:",a),t(i.mK),{success:!1,error:a.message}}}}}},2725:(e,t,s)=>{s.d(t,{A:()=>a});var r=s(7055),n=s(9222),i=s(7488);const o=["message","type","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","pauseOnFocusLoss","draggable","theme","transition"],a=()=>{const e=e=>{let{message:t,type:s="default",position:a="top-right",autoClose:l=2e3,hideProgressBar:c=!1,closeOnClick:d=!0,pauseOnHover:h=!1,pauseOnFocusLoss:u=!1,draggable:p=!0,theme:f="light",transition:g=i.br}=e,A=(0,n.A)(e,o);(i.oR[s]||i.oR)(t,(0,r.A)({position:a,autoClose:l,hideProgressBar:c,closeOnClick:d,pauseOnHover:h,draggable:p,theme:f,transition:g},A))};return{showToast:e,showSuccessToast:function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e((0,r.A)({message:t,type:"success"},s))},showErrorToast:function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e((0,r.A)({message:t,type:"error"},s))},showInfoToast:function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e((0,r.A)({message:t,type:"info"},s))},showWarningToast:function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e((0,r.A)({message:t,type:"warn"},s))}}}},6317:(e,t,s)=>{s.d(t,{r:()=>S,A:()=>D});var r=s(7055),n=s(5043),i=s(3969),o=s(4799),a=s(5974),l=s(13),c=s(1449),d=s(2097),h=s(4842),u=s(3759),p=s(579);const f=e=>{let{parentParts:t,sourceOrg:s,selectedItems:r}=e;return(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)(a.A,{spacing:3,children:[(0,p.jsxs)(i.A,{children:[(0,p.jsx)(h.A,{variant:"subtitle1",sx:{fontWeight:"medium"},children:"Parent item(s) to Assign:"}),(0,p.jsx)(h.A,{variant:"body1",sx:{marginBottom:2,whiteSpace:"pre-line"},children:t})]}),(0,p.jsxs)(i.A,{children:[(0,p.jsx)(h.A,{variant:"subtitle1",sx:{fontWeight:"medium"},children:"Source Organization:"}),(0,p.jsx)(h.A,{variant:"body1",sx:{marginBottom:2},children:s})]}),(0,p.jsxs)(i.A,{children:[(0,p.jsx)(h.A,{variant:"subtitle1",sx:{fontWeight:"medium"},children:"Items to be Processed:"}),r.length>0?(0,p.jsx)(i.A,{sx:{display:"flex",flexWrap:"wrap",gap:1,marginTop:1},children:r.map((e=>(0,p.jsx)(u.A,{label:e,color:"primary"},e)))}):(0,p.jsx)(h.A,{variant:"body2",color:"textSecondary",children:"No items selected."})]})]})})};var g=s(3546),A=s(3605),v=s(6020);const m=e=>{let{message:t}=e;return(0,p.jsxs)(o.A,{sx:{padding:4,width:"100%",maxWidth:600,borderRadius:4,boxShadow:3,textAlign:"center",backgroundColor:"#f5f5f5",border:"2px solid #3f51b5"},children:[(0,p.jsx)(i.A,{sx:{marginBottom:2},children:(0,p.jsx)(h.A,{variant:"h6",color:"primary",fontWeight:"bold",children:t})}),(0,p.jsx)(v.A,{color:"primary"})]})};function b(e){let{children:t,isOpen:s,onSubmit:r,onCancel:i,disabled:o,title:l}=e;const c=(0,n.useRef)(null);return(0,n.useEffect)((()=>{const e=new AbortController,{signal:t}=e;return s&&window.addEventListener("mousedown",(function(e){c.current&&!c.current.contains(e.target)&&i()}),{signal:t}),()=>e.abort()}),[s,i]),(0,p.jsx)("div",{className:"flex justify-center items-center",children:(0,p.jsx)(g.N,{children:s&&(0,p.jsx)(A.P.div,{className:"fixed inset-0 flex items-center justify-center backdrop-blur-xs bg-black/30 z-10",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,p.jsxs)(A.P.div,{ref:c,className:"bg-white rounded-2xl p-6 shadow-xl min-w-[70%] md:min-w-[40%] max-w-[60%]",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},children:[(0,p.jsx)(h.A,{variant:"h5",sx:{fontWeight:"bold",textAlign:"center"},children:l}),o&&(0,p.jsx)("div",{className:"w-full flex justify-center py-4",children:(0,p.jsx)(m,{message:"Searching for parts..."})}),t,(0,p.jsxs)(a.A,{direction:"row",spacing:2,justifyContent:"flex-end",className:"pt-4",children:[(0,p.jsx)(d.A,{variant:"contained",color:"primary",onClick:r,disabled:o,children:"Confirm"}),(0,p.jsx)(d.A,{variant:"outlined",color:"secondary",onClick:i,disabled:o,children:"Cancel"})]})]})})})})}var x=s(3774),w=s(7122);const y=(0,x.eU)(!1);var j=s(9522),R=s(3768);var C=s(5906);const O=e=>{var t,s;let{selectedItems:n,onChange:a,disabled:c}=e;const d=e=>{!e||null!==n&&void 0!==n&&n.includes(e)||a([...n,e])},{data:f}=(0,j.Z6)({}),{data:g}=(0,j.sQ)({});return(0,p.jsxs)(i.A,{sx:{width:"100%",display:"flex",flexDirection:"column",gap:2},children:[(0,p.jsx)(C.A,{options:null!==(t=null===f||void 0===f?void 0:f.data)&&void 0!==t?t:[],onChange:(e,t)=>d(t),renderInput:e=>(0,p.jsx)(l.A,(0,r.A)((0,r.A)({},e),{},{label:"RDO Name (will appear in Selected Plants)",fullWidth:!0,variant:"outlined",disabled:c}))}),(0,p.jsx)(C.A,{options:null!==(s=null===g||void 0===g?void 0:g.data)&&void 0!==s?s:[],onChange:(e,t)=>d(t),renderInput:e=>(0,p.jsx)(l.A,(0,r.A)((0,r.A)({},e),{},{label:"Destination JDI Orgs (will appear in Selected Plants)",fullWidth:!0,variant:"outlined",disabled:c}))}),(0,p.jsx)(h.A,{variant:"caption",color:"textSecondary",children:"Selections from both fields will appear below."}),(0,p.jsxs)(o.A,{sx:{padding:2,borderRadius:2,boxShadow:2,maxHeight:200,overflowY:"auto"},children:[(0,p.jsx)(h.A,{variant:"subtitle1",sx:{fontWeight:"bold",marginBottom:2},children:"Selected Plants"}),(0,p.jsx)(i.A,{sx:{display:"flex",flexWrap:"wrap",gap:1,minHeight:20},children:n.map((e=>(0,p.jsx)(u.A,{label:e,onDelete:()=>{return t=e,void a(null===n||void 0===n?void 0:n.filter((e=>e!==t)));var t},color:"primary"},e)))})]})]})},S=()=>{const[e,t]=(0,n.useState)({}),[s,h]=(0,n.useState)({parentParts:"",sourceOrg:"",plants:[]}),u=(e,t)=>{h((s=>(0,r.A)((0,r.A)({},s),{},{[e]:t})))},{isOpen:g,setIsOpen:A}=(()=>{const[e,t]=(0,w.fp)(y);return{isOpen:e,setIsOpen:t}})(),v=()=>A(!1),[m,{isLoading:x}]=(0,j.nh)();return(0,p.jsxs)(i.A,{sx:{minHeight:"calc(100vh - 65px)",backgroundColor:"#eef2f6"},children:[(0,p.jsx)(b,{isOpen:g,title:"Confirm Your Submission",onSubmit:async()=>{const{data:e,error:t}=await m({parentPart:s.parentParts,sourceOrg:s.sourceOrg,plants:s.plants});t&&R.Ay.error(function(e){if(e&&"object"===typeof e&&"data"in e){const t=e;if("object"===typeof t.data&&null!==t.data&&"message"in t.data)return t.data.message}return"object"===typeof e&&null!==e&&"message"in e?(console.error(e),e.message):"An unexpected error occurred."}(t)),A(!1),R.Ay.success(e.message)},onCancel:v,disabled:x,children:(0,p.jsx)(f,{parentParts:s.parentParts,sourceOrg:s.sourceOrg,selectedItems:s.plants})}),(0,p.jsxs)(i.A,{sx:{padding:4,display:"flex",flexDirection:"column",alignItems:"center",gap:4,minHeight:"calc(100vh - 200px)"},children:[(0,p.jsx)(o.A,{sx:{padding:4,width:"100%",maxWidth:600,borderRadius:4,boxShadow:3},children:(0,p.jsx)("form",{onSubmit:e=>{e.preventDefault();const r={};s.parentParts.trim()||(r.parentParts="Parent Part is required"),s.sourceOrg.trim()||(r.sourceOrg="Source org is required"),s.plants.length||(r.plants="Select either RDO Name or Destination JDI Org"),t(r),0===Object.keys(r).length&&A(!0)},children:(0,p.jsxs)(a.A,{spacing:3,children:[(0,p.jsx)(l.A,{label:"Parent item(s) to Assign",variant:"outlined",value:s.parentParts,onChange:e=>u("parentParts",e.target.value),error:!!e.parentParts,helperText:e.parentParts,fullWidth:!0}),(0,p.jsx)(l.A,{label:"Source Organization",variant:"outlined",value:s.sourceOrg,onChange:e=>u("sourceOrg",e.target.value),error:!!e.sourceOrg,helperText:e.sourceOrg,fullWidth:!0}),(0,p.jsx)(O,{selectedItems:s.plants,onChange:e=>u("plants",e),disabled:!1}),e.plants&&(0,p.jsx)(c.A,{severity:"error",children:e.plants}),(0,p.jsxs)(a.A,{direction:"row",spacing:2,justifyContent:"flex-end",children:[(0,p.jsx)(d.A,{type:"submit",variant:"contained",color:"primary",children:"Submit"}),(0,p.jsx)(d.A,{type:"button",variant:"outlined",color:"secondary",onClick:v,children:"Cancel"})]})]})})}),!1]})]})},D=S},8495:(e,t,s)=>{s.r(t),s.d(t,{default:()=>xe});var r=s(4391),n=s(5091),i=s(5043),o=s(174),a=s(2725),l=s(8012),c=s(3277),d=s(7726),h=s(6713),u=s(579);const p=()=>{const{handleDrop:e}=(0,l.A)(),{showSuccessToast:t,showErrorToast:s}=(0,a.A)(),[r,n]=(0,i.useState)(!1);return(0,i.useEffect)((()=>{if(!window.widget)return;console.trace("[WidgetLifecycle] \ud83d\udd04 `onRefresh` was called from:"),window.widget.addEvent("onRefresh",(async()=>{var r,i;const a=(new Error).stack.split("\n"),l=sessionStorage.getItem("userClickedRefresh");if((e=>e.some((e=>e.includes("UWA_Frame_Alone.js")||e.includes("bundle-min.js"))))(a)&&!l)return void console.warn("[WidgetLifecycle] \u26d4 Auto-refresh detected. Ignoring unwanted `onRefresh`.");sessionStorage.removeItem("userClickedRefresh"),n(!0);const h=d.A.getState().droppedObject.droppedObjectData.initialDraggedData;if(null===h||void 0===h||null===(r=h.data)||void 0===r||null===(i=r.items)||void 0===i||!i.length)return console.error("[WidgetLifecycle] \u26a0\ufe0f `initialDraggedData` is missing or invalid:",h),void n(!1);try{await(0,o.M)(h.data.items,e)}catch(u){console.error("[WidgetLifecycle] \u274c Error during refresh:",u),s(c.H6)}finally{n(!1),t(c._l)}}))}),[]),r?(0,u.jsx)(h.A,{}):null};let f=null;function g(e){if(function(){if(window.parent&&window.parent.document){let e=window.parent.document.createElement("script");e.textContent='\n      function listenForRefreshClicks() {\n        // console.log("\ud83c\udf0d [Parent] Listening for manual refresh clicks...");\n  \n        document.body.addEventListener("click", function (event) {\n          let refreshButton = event.target.closest("#refresh"); // Check if refresh was clicked\n  \n          if (refreshButton) {\n            // console.log("\u2705 [Parent] User clicked Refresh!");\n            sessionStorage.setItem("userClickedRefresh", "true"); // Store flag\n            // console.log("Stored Flag:", sessionStorage.getItem("userClickedRefresh"));\n          }\n        }, true);\n      }\n  \n      // \u2705 Ensure event listener is added even if DOM is already loaded\n      if (document.readyState === "loading") {\n        document.addEventListener("DOMContentLoaded", listenForRefreshClicks);\n      } else {\n        listenForRefreshClicks();\n      }\n    ',window.parent.document.body.appendChild(e)}else console.warn("\u26a0\ufe0f [index.js] Unable to inject script\u2014parent window not accessible.")}(),window.widget){let t=!1;window.widget.addEvent("onLoad",(()=>{t?console.warn("\u23f3 onLoad was already executed. Ignoring duplicate trigger."):(t=!0,function(e){var t;requirejs(["DS/PlatformAPI/PlatformAPI"],(e=>{window.PlatformAPI=e}));const s=window.widget;let i=(null===s||void 0===s||null===(t=s.body)||void 0===t?void 0:t.querySelector("#root"))||document.getElementById("root");i||(i=document.createElement("div"),i.id="root",((null===s||void 0===s?void 0:s.body)||document.body).appendChild(i)),f=f||(0,r.createRoot)(i),f.render((0,u.jsxs)(n.b,{children:[(0,u.jsx)(p,{}),e]}))}(e))}))}else console.error("\u274c Widget not detected! onLoad cannot be registered.");return e}var A=s(6317),v=s(3003),m=s(1358);var b=s(360),x=s(5645),w=s(314),y=s(7055);var j,R,C,O,S,D,k,E,P,I,_,W,T,M,F,L,N=s(4442),q=s(249),U=s(8774),Q=s(9110),H=s(8706),B=s(3491),z=s(1454),K=s(9210),$=s(329),V=s(9567),Z=s(9723),G=(j=new WeakMap,R=new WeakMap,C=new WeakMap,O=new WeakMap,S=new WeakMap,D=new WeakMap,k=new WeakMap,E=new WeakMap,P=new WeakMap,I=new WeakMap,_=new WeakMap,W=new WeakMap,T=new WeakMap,M=new WeakMap,F=new WeakMap,L=new WeakSet,class extends $.Q{constructor(e,t){super(),(0,N.A)(this,L),(0,q.A)(this,j,void 0),(0,q.A)(this,R,void 0),(0,q.A)(this,C,void 0),(0,q.A)(this,O,void 0),(0,q.A)(this,S,void 0),(0,q.A)(this,D,void 0),(0,q.A)(this,k,void 0),(0,q.A)(this,E,void 0),(0,q.A)(this,P,void 0),(0,q.A)(this,I,void 0),(0,q.A)(this,_,void 0),(0,q.A)(this,W,void 0),(0,q.A)(this,T,void 0),(0,q.A)(this,M,void 0),(0,q.A)(this,F,new Set),this.options=t,(0,H.A)(j,this,e),(0,H.A)(E,this,null),(0,H.A)(k,this,(0,V.T)()),this.options.experimental_prefetchInRender||(0,Q.A)(k,this).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(t)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&((0,Q.A)(R,this).addObserver(this),oe((0,Q.A)(R,this),this.options)?(0,U.A)(L,this,J).call(this):this.updateResult(),(0,U.A)(L,this,te).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ae((0,Q.A)(R,this),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ae((0,Q.A)(R,this),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,(0,U.A)(L,this,se).call(this),(0,U.A)(L,this,re).call(this),(0,Q.A)(R,this).removeObserver(this)}setOptions(e){const t=this.options,s=(0,Q.A)(R,this);if(this.options=(0,Q.A)(j,this).defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!==typeof this.options.enabled&&"function"!==typeof this.options.enabled&&"boolean"!==typeof(0,Z.Eh)(this.options.enabled,(0,Q.A)(R,this)))throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");(0,U.A)(L,this,ne).call(this),(0,Q.A)(R,this).setOptions(this.options),t._defaulted&&!(0,Z.f8)(this.options,t)&&(0,Q.A)(j,this).getQueryCache().notify({type:"observerOptionsUpdated",query:(0,Q.A)(R,this),observer:this});const r=this.hasListeners();r&&le((0,Q.A)(R,this),s,this.options,t)&&(0,U.A)(L,this,J).call(this),this.updateResult(),!r||(0,Q.A)(R,this)===s&&(0,Z.Eh)(this.options.enabled,(0,Q.A)(R,this))===(0,Z.Eh)(t.enabled,(0,Q.A)(R,this))&&(0,Z.d2)(this.options.staleTime,(0,Q.A)(R,this))===(0,Z.d2)(t.staleTime,(0,Q.A)(R,this))||(0,U.A)(L,this,X).call(this);const n=(0,U.A)(L,this,Y).call(this);!r||(0,Q.A)(R,this)===s&&(0,Z.Eh)(this.options.enabled,(0,Q.A)(R,this))===(0,Z.Eh)(t.enabled,(0,Q.A)(R,this))&&n===(0,Q.A)(M,this)||(0,U.A)(L,this,ee).call(this,n)}getOptimisticResult(e){const t=(0,Q.A)(j,this).getQueryCache().build((0,Q.A)(j,this),e),s=this.createResult(t,e);return function(e,t){if(!(0,Z.f8)(e.getCurrentResult(),t))return!0;return!1}(this,s)&&((0,H.A)(O,this,s),(0,H.A)(D,this,this.options),(0,H.A)(S,this,(0,Q.A)(R,this).state)),s}getCurrentResult(){return(0,Q.A)(O,this)}trackResult(e,t){const s={};return Object.keys(e).forEach((r=>{Object.defineProperty(s,r,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(r),null===t||void 0===t||t(r),e[r])})})),s}trackProp(e){(0,Q.A)(F,this).add(e)}getCurrentQuery(){return(0,Q.A)(R,this)}refetch(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e),e));return this.fetch((0,y.A)({},t))}fetchOptimistic(e){const t=(0,Q.A)(j,this).defaultQueryOptions(e),s=(0,Q.A)(j,this).getQueryCache().build((0,Q.A)(j,this),t);return s.fetch().then((()=>this.createResult(s,t)))}fetch(e){var t;return(0,U.A)(L,this,J).call(this,(0,y.A)((0,y.A)({},e),{},{cancelRefetch:null===(t=e.cancelRefetch)||void 0===t||t})).then((()=>(this.updateResult(),(0,Q.A)(O,this))))}createResult(e,t){const s=(0,Q.A)(R,this),r=this.options,n=(0,Q.A)(O,this),i=(0,Q.A)(S,this),o=(0,Q.A)(D,this),a=e!==s?e.state:(0,Q.A)(C,this),{state:l}=e;let c,d=(0,y.A)({},l),h=!1;if(t._optimisticResults){const n=this.hasListeners(),i=!n&&oe(e,t),o=n&&le(e,s,t,r);(i||o)&&(d=(0,y.A)((0,y.A)({},d),(0,K.k)(l.data,e.options))),"isRestoring"===t._optimisticResults&&(d.fetchStatus="idle")}let{error:u,errorUpdatedAt:p,status:f}=d;if(t.select&&void 0!==d.data)if(n&&d.data===(null===i||void 0===i?void 0:i.data)&&t.select===(0,Q.A)(P,this))c=(0,Q.A)(I,this);else try{(0,H.A)(P,this,t.select),c=t.select(d.data),c=(0,Z.pl)(null===n||void 0===n?void 0:n.data,c,t),(0,H.A)(I,this,c),(0,H.A)(E,this,null)}catch(j){(0,H.A)(E,this,j)}else c=d.data;if(void 0!==t.placeholderData&&void 0===c&&"pending"===f){let e;var g;if(null!==n&&void 0!==n&&n.isPlaceholderData&&t.placeholderData===(null===o||void 0===o?void 0:o.placeholderData))e=n.data;else if(e="function"===typeof t.placeholderData?t.placeholderData(null===(g=(0,Q.A)(_,this))||void 0===g?void 0:g.state.data,(0,Q.A)(_,this)):t.placeholderData,t.select&&void 0!==e)try{e=t.select(e),(0,H.A)(E,this,null)}catch(j){(0,H.A)(E,this,j)}void 0!==e&&(f="success",c=(0,Z.pl)(null===n||void 0===n?void 0:n.data,e,t),h=!0)}(0,Q.A)(E,this)&&(u=(0,Q.A)(E,this),c=(0,Q.A)(I,this),p=Date.now(),f="error");const A="fetching"===d.fetchStatus,v="pending"===f,m="error"===f,b=v&&A,x=void 0!==c,w={status:f,fetchStatus:d.fetchStatus,isPending:v,isSuccess:"success"===f,isError:m,isInitialLoading:b,isLoading:b,data:c,dataUpdatedAt:d.dataUpdatedAt,error:u,errorUpdatedAt:p,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>a.dataUpdateCount||d.errorUpdateCount>a.errorUpdateCount,isFetching:A,isRefetching:A&&!v,isLoadingError:m&&!x,isPaused:"paused"===d.fetchStatus,isPlaceholderData:h,isRefetchError:m&&x,isStale:ce(e,t),refetch:this.refetch,promise:(0,Q.A)(k,this)};if(this.options.experimental_prefetchInRender){const t=e=>{"error"===w.status?e.reject(w.error):void 0!==w.data&&e.resolve(w.data)},r=()=>{const e=(0,H.A)(k,this,w.promise=(0,V.T)());t(e)},n=(0,Q.A)(k,this);switch(n.status){case"pending":e.queryHash===s.queryHash&&t(n);break;case"fulfilled":"error"!==w.status&&w.data===n.value||r();break;case"rejected":"error"===w.status&&w.error===n.reason||r()}}return w}updateResult(){const e=(0,Q.A)(O,this),t=this.createResult((0,Q.A)(R,this),this.options);if((0,H.A)(S,this,(0,Q.A)(R,this).state),(0,H.A)(D,this,this.options),void 0!==(0,Q.A)(S,this).data&&(0,H.A)(_,this,(0,Q.A)(R,this)),(0,Z.f8)(t,e))return;(0,H.A)(O,this,t);(0,U.A)(L,this,ie).call(this,{listeners:(()=>{if(!e)return!0;const{notifyOnChangeProps:t}=this.options,s="function"===typeof t?t():t;if("all"===s||!s&&!(0,Q.A)(F,this).size)return!0;const r=new Set(null!==s&&void 0!==s?s:(0,Q.A)(F,this));return this.options.throwOnError&&r.add("error"),Object.keys((0,Q.A)(O,this)).some((t=>{const s=t;return(0,Q.A)(O,this)[s]!==e[s]&&r.has(s)}))})()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&(0,U.A)(L,this,te).call(this)}});function J(e){(0,U.A)(L,this,ne).call(this);let t=(0,Q.A)(R,this).fetch(this.options,e);return null!==e&&void 0!==e&&e.throwOnError||(t=t.catch(Z.lQ)),t}function X(){(0,U.A)(L,this,se).call(this);const e=(0,Z.d2)(this.options.staleTime,(0,Q.A)(R,this));if(Z.S$||(0,Q.A)(O,this).isStale||!(0,Z.gn)(e))return;const t=(0,Z.j3)((0,Q.A)(O,this).dataUpdatedAt,e)+1;(0,H.A)(W,this,setTimeout((()=>{(0,Q.A)(O,this).isStale||this.updateResult()}),t))}function Y(){var e;return null!==(e="function"===typeof this.options.refetchInterval?this.options.refetchInterval((0,Q.A)(R,this)):this.options.refetchInterval)&&void 0!==e&&e}function ee(e){(0,U.A)(L,this,re).call(this),(0,H.A)(M,this,e),!Z.S$&&!1!==(0,Z.Eh)(this.options.enabled,(0,Q.A)(R,this))&&(0,Z.gn)((0,Q.A)(M,this))&&0!==(0,Q.A)(M,this)&&(0,H.A)(T,this,setInterval((()=>{(this.options.refetchIntervalInBackground||B.m.isFocused())&&(0,U.A)(L,this,J).call(this)}),(0,Q.A)(M,this)))}function te(){(0,U.A)(L,this,X).call(this),(0,U.A)(L,this,ee).call(this,(0,U.A)(L,this,Y).call(this))}function se(){(0,Q.A)(W,this)&&(clearTimeout((0,Q.A)(W,this)),(0,H.A)(W,this,void 0))}function re(){(0,Q.A)(T,this)&&(clearInterval((0,Q.A)(T,this)),(0,H.A)(T,this,void 0))}function ne(){const e=(0,Q.A)(j,this).getQueryCache().build((0,Q.A)(j,this),this.options);if(e===(0,Q.A)(R,this))return;const t=(0,Q.A)(R,this);(0,H.A)(R,this,e),(0,H.A)(C,this,e.state),this.hasListeners()&&(null===t||void 0===t||t.removeObserver(this),e.addObserver(this))}function ie(e){z.jG.batch((()=>{e.listeners&&this.listeners.forEach((e=>{e((0,Q.A)(O,this))})),(0,Q.A)(j,this).getQueryCache().notify({query:(0,Q.A)(R,this),type:"observerResultsUpdated"})}))}function oe(e,t){return function(e,t){return!1!==(0,Z.Eh)(t.enabled,e)&&void 0===e.state.data&&!("error"===e.state.status&&!1===t.retryOnMount)}(e,t)||void 0!==e.state.data&&ae(e,t,t.refetchOnMount)}function ae(e,t,s){if(!1!==(0,Z.Eh)(t.enabled,e)){const r="function"===typeof s?s(e):s;return"always"===r||!1!==r&&ce(e,t)}return!1}function le(e,t,s,r){return(e!==t||!1===(0,Z.Eh)(r.enabled,e))&&(!s.suspense||"error"!==e.state.status)&&ce(e,s)}function ce(e,t){return!1!==(0,Z.Eh)(t.enabled,e)&&e.isStaleByTime((0,Z.d2)(t.staleTime,e))}var de=s(3248);function he(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var ue=i.createContext(he());function pe(){}var fe=i.createContext(!1),ge=(fe.Provider,(e,t,s)=>t.fetchOptimistic(e).catch((()=>{s.clearReset()})));function Ae(e,t,s){var r,n,o,a;const l=(0,de.jE)(s),c=i.useContext(fe),d=i.useContext(ue),h=l.defaultQueryOptions(e);null===(r=l.getDefaultOptions().queries)||void 0===r||null===(n=r._experimental_beforeQuery)||void 0===n||n.call(r,h),h._optimisticResults=c?"isRestoring":"optimistic",(e=>{const t=e.staleTime;e.suspense&&(e.staleTime="function"===typeof t?function(){return Math.max(t(...arguments),1e3)}:Math.max(null!==t&&void 0!==t?t:1e3,1e3),"number"===typeof e.gcTime&&(e.gcTime=Math.max(e.gcTime,1e3)))})(h),((e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))})(h,d),(e=>{i.useEffect((()=>{e.clearReset()}),[e])})(d);const u=!l.getQueryCache().get(h.queryHash),[p]=i.useState((()=>new t(l,h))),f=p.getOptimisticResult(h),g=!c&&!1!==e.subscribed;if(i.useSyncExternalStore(i.useCallback((e=>{const t=g?p.subscribe(z.jG.batchCalls(e)):pe;return p.updateResult(),t}),[p,g]),(()=>p.getCurrentResult()),(()=>p.getCurrentResult())),i.useEffect((()=>{p.setOptions(h)}),[h,p]),((e,t)=>(null===e||void 0===e?void 0:e.suspense)&&t.isPending)(h,f))throw ge(h,p,d);if((e=>{let{result:t,errorResetBoundary:s,throwOnError:r,query:n,suspense:i}=e;return t.isError&&!s.isReset()&&!t.isFetching&&n&&(i&&void 0===t.data||(o=r,a=[t.error,n],"function"===typeof o?o(...a):!!o));var o,a})({result:f,errorResetBoundary:d,throwOnError:h.throwOnError,query:l.getQueryCache().get(h.queryHash),suspense:h.suspense}))throw f.error;if(null===(o=l.getDefaultOptions().queries)||void 0===o||null===(a=o._experimental_afterQuery)||void 0===a||a.call(o,h,f),h.experimental_prefetchInRender&&!Z.S$&&((e,t)=>e.isLoading&&e.isFetching&&!t)(f,c)){var A;const e=u?ge(h,p,d):null===(A=l.getQueryCache().get(h.queryHash))||void 0===A?void 0:A.promise;null===e||void 0===e||e.catch(pe).finally((()=>{p.updateResult()}))}return h.notifyOnChangeProps?f:p.trackResult(f)}function ve(e,t){return Ae(e,G,t)}const me=e=>{let{children:t,objectDropped:s}=e;const{showErrorToast:r}=(0,a.A)(),{fetchRevisionsAndParents:n}=(0,b.A)(),o=(0,v.wA)(),l=(0,v.d4)((e=>e.droppedObject.isDropped)),d=(0,v.d4)((e=>e.droppedObject));(0,v.d4)((e=>e.droppedObject.loading));console.info("dataaa.................",d);const p=(0,i.useCallback)((async e=>{try{const i=await(0,w.Sj)({dataItems:e});if(console.warn("objectDetailsResult....................",i),i.success){var t,s;o((0,x.gg)(i));const r=i.data.cardData.relativePath,[a]=await Promise.all([n(null===(t=e[0])||void 0===t?void 0:t.objectId,null===(s=e[0])||void 0===s?void 0:s.objectType,r)]);o((0,x.um)({cardData:i.data.cardData,parentDetails:a||[]})),console.log("[fetchObjectDetails] \u2705 Redux store updated.")}else r(c.wX)}catch(i){console.error("[FetchObjectDetails] Error fetching details:",i),r(c.wX)}finally{console.log("[fetchObjectDetails] \ud83c\udfc1 Ensuring loading is reset."),o((0,x.r1)(!1))}}),[o,n,r]),f=(0,i.useCallback)((async e=>{console.log("[handleDrop] handleDrop called with dataItems:",e);try{if(e&&e.length>0){var t;const s=null===(t=e[0])||void 0===t?void 0:t.objectType;if(!["VPMReference","Document","Raw_Material"].includes(s))return void r(c.Zo);o((0,x.Rr)(!0)),console.log("[handleDrop] \ud83d\udd04 Force setting `loading = true`..."),o((0,x.r1)(!1)),setTimeout((()=>o((0,x.r1)(!0))),0),o((0,x._Q)(e)),await p(e)}else console.warn("[handleDrop] No data items to process.")}catch(s){console.error("[Drop] Error in handleDrop:",s),o((0,x.r1)(!1)),console.log("[handleDrop] Error in handleDrop, setting loading to false"),r(c.nz)}}),[r]),{data:g,isLoading:A}=ve({queryKey:["droppableContainer"],queryFn:()=>new Promise((e=>{const t=setInterval((()=>{const s=document.querySelector(".droppable-container");s?(clearInterval(t),e(s)):e(!1)}),100)}))}),{isFetching:y}=ve({queryKey:["initdrop"],queryFn:async()=>{l?console.log("[initializeDroppableArea] \u23f3 isDropped is already true. Skipping reset."):(console.log("[initializeDroppableArea] \ud83d\ude80 Resetting isDropped to false..."),o((0,x.Rr)(!1))),await(0,w.pn)(g,f,o,r)},enabled:!!g});return y?(0,u.jsx)(h.A,{}):l?t:(0,u.jsx)(m.A,{handleDrop:f})},be=()=>{const e=(0,v.d4)((e=>e.droppedObject.loadingParentDetails)),t=(0,v.d4)((e=>e.droppedObject));return console.warn("dataaa.................",t),(0,u.jsx)(me,{objectDropped:e,children:(0,u.jsx)(A.r,{})})},xe=()=>g((0,u.jsx)(be,{}))},5091:(e,t,s)=>{s.d(t,{b:()=>u});var r=s(5043),n=s(5725),i=s(3248),o=s(3003),a=s(9367),l=s(3768),c=s(7488),d=s(7726),h=(s(2342),s(8421),s(8885),s(9555),s(4050),s(9959),s(579));const u=e=>{let{children:t}=e;const s=new n.E;return(0,h.jsx)(a.vd,{children:(0,h.jsx)(o.Kq,{store:d.A,children:(0,h.jsx)(i.Ht,{client:s,children:(0,h.jsxs)(r.Suspense,{fallback:(0,h.jsx)("h1",{children:"loading"}),children:[(0,h.jsx)(l.l$,{position:"top-center",reverseOrder:!1}),(0,h.jsx)(c.N9,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!1,pauseOnFocusLoss:!1,draggable:!0,theme:"light",transition:c.br}),t]})})})})}},174:(e,t,s)=>{s.d(t,{M:()=>r});const r=async(e,t)=>{if(console.log("[refreshWidgetData] called with dataItems:",e),e&&0!==e.length)try{if("function"!==typeof t)throw new Error("[Refresh] handleDrop is not a function.");await t(e)}catch(s){console.error("[Refresh] Error during handleDrop execution:",s)}else console.warn("[Refresh] No dropped data available to refresh.")}},4050:()=>{},4119:()=>{},9555:()=>{},9959:()=>{}}]);
//# sourceMappingURL=495.6865a81b.chunk.js.map