"use strict";(self.webpackChunkreact_widget_template=self.webpackChunkreact_widget_template||[]).push([[697],{3215:(e,t,n)=>{n.d(t,{A:()=>u});var r=n(5043),s=n(174),i=n(2725),a=n(8012),o=n(3277),l=n(7726),d=n(6713),c=n(579);const u=()=>{const{handleDrop:e}=(0,a.A)(),{showSuccessToast:t,showErrorToast:n}=(0,i.A)(),[u,p]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{if(!window.widget)return;console.trace("[WidgetLifecycle] \ud83d\udd04 `onRefresh` was called from:"),window.widget.addEvent("onRefresh",(async()=>{var r,i;const a=(new Error).stack.split("\n"),d=sessionStorage.getItem("userClickedRefresh");if((e=>e.some((e=>e.includes("UWA_Frame_Alone.js")||e.includes("bundle-min.js"))))(a)&&!d)return void console.warn("[WidgetLifecycle] \u26d4 Auto-refresh detected. Ignoring unwanted `onRefresh`.");sessionStorage.removeItem("userClickedRefresh"),p(!0);const c=l.A.getState().droppedObject.droppedObjectData.initialDraggedData;if(null===c||void 0===c||null===(r=c.data)||void 0===r||null===(i=r.items)||void 0===i||!i.length)return console.error("[WidgetLifecycle] \u26a0\ufe0f `initialDraggedData` is missing or invalid:",c),void p(!1);try{await(0,s.M)(c.data.items,e)}catch(u){console.error("[WidgetLifecycle] \u274c Error during refresh:",u),n(o.H6)}finally{p(!1),t(o._l)}}))}),[]),u?(0,c.jsx)(d.A,{}):null}},1358:(e,t,n)=>{n.d(t,{A:()=>l});n(5043);var r=n(8012),s=(n(4119),n(3637)),i=n(1397),a=n(4675),o=n(579);const l=()=>{const{handleDrop:e}=(0,r.A)(),{performSearch:t}=(0,a.A)();return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"droppable-container mt-4",children:[(0,o.jsx)(s.A,{style:{width:"90px",height:"90px"},src:"https://thewhitechamaleon.github.io/testrapp/images/drag.png",alt:"Data Collect",className:"search-icon"}),(0,o.jsx)("span",{className:"drag-and-drop-text",children:"Drag and Drop"}),(0,o.jsxs)("div",{className:"divider-container",children:[(0,o.jsx)("hr",{className:"divider"}),(0,o.jsx)("span",{className:"divider-text",children:"or"}),(0,o.jsx)("hr",{className:"divider"})]}),(0,o.jsx)(i.A,{onSearch:n=>{t(n,{title:"Search",role:"",mode:"furtive",default_with_precond:!0,precond:'flattenedtaxonomies:"types/VPMReference" OR flattenedtaxonomies:"types/Raw_Material" OR flattenedtaxonomies:"types/Document"',show_precond:!1,multiSel:!1,idcard_activated:!1,select_result_max_idcard:!1,itemViewClickHandler:"",search_delegation:"3dsearch"},(t=>{t&&t.length>0&&t[0].id?e([{objectId:t[0].id,objectType:t[0]["ds6w:type_value"]}]):console.warn("No objectId found in selected objects")}))}})]})})}},9241:(e,t,n)=>{n.d(t,{r:()=>W,A:()=>N});var r=n(7055),s=n(5043),i=n(3969),a=n(4799),o=n(5974),l=n(13),d=n(1449),c=n(2097),u=n(4842),p=n(3759),h=n(579);const g=e=>{let{parentParts:t,sourceOrg:n,selectedItems:r}=e;return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)(o.A,{spacing:3,children:[(0,h.jsxs)(i.A,{children:[(0,h.jsx)(u.A,{variant:"subtitle1",sx:{fontWeight:"medium"},children:"Parent item(s) to Assign:"}),(0,h.jsx)(u.A,{variant:"body1",sx:{marginBottom:2,whiteSpace:"pre-line"},children:t})]}),(0,h.jsxs)(i.A,{children:[(0,h.jsx)(u.A,{variant:"subtitle1",sx:{fontWeight:"medium"},children:"Source Organization:"}),(0,h.jsx)(u.A,{variant:"body1",sx:{marginBottom:2},children:n})]}),(0,h.jsxs)(i.A,{children:[(0,h.jsx)(u.A,{variant:"subtitle1",sx:{fontWeight:"medium"},children:"Items to be Processed:"}),r.length>0?(0,h.jsx)(i.A,{sx:{display:"flex",flexWrap:"wrap",gap:1,marginTop:1},children:r.map((e=>(0,h.jsx)(p.A,{label:e,color:"primary"},e)))}):(0,h.jsx)(u.A,{variant:"body2",color:"textSecondary",children:"No items selected."})]})]})})};var x=n(3546),m=n(3605),f=n(6020);const j=e=>{let{message:t}=e;return(0,h.jsxs)(a.A,{sx:{padding:4,width:"100%",maxWidth:600,borderRadius:4,boxShadow:3,textAlign:"center",backgroundColor:"#f5f5f5",border:"2px solid #3f51b5"},children:[(0,h.jsx)(i.A,{sx:{marginBottom:2},children:(0,h.jsx)(u.A,{variant:"h6",color:"primary",fontWeight:"bold",children:t})}),(0,h.jsx)(f.A,{color:"primary"})]})};function v(e){let{children:t,isOpen:n,onSubmit:r,onCancel:i,disabled:a,title:l}=e;const d=(0,s.useRef)(null);return(0,s.useEffect)((()=>{const e=new AbortController,{signal:t}=e;return n&&window.addEventListener("mousedown",(function(e){d.current&&!d.current.contains(e.target)&&i()}),{signal:t}),()=>e.abort()}),[n,i]),(0,h.jsx)("div",{className:"flex justify-center items-center",children:(0,h.jsx)(x.N,{children:n&&(0,h.jsx)(m.P.div,{className:"fixed inset-0 flex items-center justify-center backdrop-blur-xs bg-black/30 z-10",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,h.jsxs)(m.P.div,{ref:d,className:"bg-white rounded-2xl p-6 shadow-xl min-w-[70%] md:min-w-[40%] max-w-[60%]",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},children:[(0,h.jsx)(u.A,{variant:"h5",sx:{fontWeight:"bold",textAlign:"center"},children:l}),a&&(0,h.jsx)("div",{className:"w-full flex justify-center py-4",children:(0,h.jsx)(j,{message:"Searching for parts..."})}),t,(0,h.jsxs)(o.A,{direction:"row",spacing:2,justifyContent:"flex-end",className:"pt-4",children:[(0,h.jsx)(c.A,{variant:"contained",color:"primary",onClick:r,disabled:a,children:"Confirm"}),(0,h.jsx)(c.A,{variant:"outlined",color:"secondary",onClick:i,disabled:a,children:"Cancel"})]})]})})})})}var b=n(3774),w=n(7122);const A=(0,b.eU)(!1);var y=n(9522),C=n(3768);var S=n(5906);const O=e=>{var t,n;let{selectedItems:s,onChange:o,disabled:d}=e;const c=e=>{!e||null!==s&&void 0!==s&&s.includes(e)||o([...s,e])},{data:g}=(0,y.Z6)({}),{data:x}=(0,y.sQ)({});return(0,h.jsxs)(i.A,{sx:{width:"100%",display:"flex",flexDirection:"column",gap:2},children:[(0,h.jsx)(S.A,{options:null!==(t=null===g||void 0===g?void 0:g.data)&&void 0!==t?t:[],onChange:(e,t)=>c(t),renderInput:e=>(0,h.jsx)(l.A,(0,r.A)((0,r.A)({},e),{},{label:"RDO Name (will appear in Selected Plants)",fullWidth:!0,variant:"outlined",disabled:d}))}),(0,h.jsx)(S.A,{options:null!==(n=null===x||void 0===x?void 0:x.data)&&void 0!==n?n:[],onChange:(e,t)=>c(t),renderInput:e=>(0,h.jsx)(l.A,(0,r.A)((0,r.A)({},e),{},{label:"Destination JDI Orgs (will appear in Selected Plants)",fullWidth:!0,variant:"outlined",disabled:d}))}),(0,h.jsx)(u.A,{variant:"caption",color:"textSecondary",children:"Selections from both fields will appear below."}),(0,h.jsxs)(a.A,{sx:{padding:2,borderRadius:2,boxShadow:2,maxHeight:200,overflowY:"auto"},children:[(0,h.jsx)(u.A,{variant:"subtitle1",sx:{fontWeight:"bold",marginBottom:2},children:"Selected Plants"}),(0,h.jsx)(i.A,{sx:{display:"flex",flexWrap:"wrap",gap:1,minHeight:20},children:s.map((e=>(0,h.jsx)(p.A,{label:e,onDelete:()=>{return t=e,void o(null===s||void 0===s?void 0:s.filter((e=>e!==t)));var t},color:"primary"},e)))})]})]})};var P=n(3003),D=n(1358),k=n(6713),I=n(8012);const R=e=>{let{children:t,objectDropped:n}=e;const{loading:r}=(0,I.A)();(()=>{const{initializeDroppableArea:e}=(0,I.A)(),t=(0,s.useRef)(!1),n=(0,s.useCallback)((()=>{t.current||(e(),t.current=!0)}),[e]),r=(0,P.d4)((e=>e.droppedObject.isDropped),P.bN);(0,s.useEffect)((()=>{n(),console.info("[RevisionFloat] State Changes:",{isDropped:r})}),[n,r])})();const i=(0,P.d4)((e=>e.droppedObject.isDropped)),a=n;return console.warn("loadingObject...............",a),r||a?(0,h.jsx)(k.A,{}):i?t:(0,h.jsx)(D.A,{})},W=()=>{const e=(0,P.d4)((e=>e.droppedObject.loadingParentDetails)),[t,n]=(0,s.useState)({}),[u,p]=(0,s.useState)({parentParts:"",sourceOrg:"",plants:[]}),x=(e,t)=>{p((n=>(0,r.A)((0,r.A)({},n),{},{[e]:t})))},{isOpen:m,setIsOpen:f}=(()=>{const[e,t]=(0,w.fp)(A);return{isOpen:e,setIsOpen:t}})(),j=()=>f(!1),[b,{isLoading:S}]=(0,y.nh)();return(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(R,{objectDropped:e,children:(0,h.jsxs)(i.A,{sx:{minHeight:"calc(100vh - 65px)",backgroundColor:"#eef2f6",overflow:"auto"},children:[(0,h.jsx)(v,{isOpen:m,title:"Confirm Your Submission",onSubmit:async()=>{const{data:e,error:t}=await b({parentPart:u.parentParts,sourceOrg:u.sourceOrg,plants:u.plants});t&&C.Ay.error(function(e){if(e&&"object"===typeof e&&"data"in e){const t=e;if("object"===typeof t.data&&null!==t.data&&"message"in t.data)return t.data.message}return"object"===typeof e&&null!==e&&"message"in e?(console.error(e),e.message):"An unexpected error occurred."}(t)),f(!1),C.Ay.success(e.message)},onCancel:j,disabled:S,children:(0,h.jsx)(g,{parentParts:u.parentParts,sourceOrg:u.sourceOrg,selectedItems:u.plants})}),(0,h.jsxs)(i.A,{sx:{padding:4,display:"flex",flexDirection:"column",alignItems:"center",gap:4,minHeight:"calc(100vh - 200px)",overflow:"auto"},children:[(0,h.jsx)(a.A,{sx:{padding:4,width:"100%",maxWidth:600,borderRadius:4,boxShadow:3},children:(0,h.jsx)("form",{onSubmit:e=>{e.preventDefault();const t={};u.parentParts.trim()||(t.parentParts="Parent Part is required"),u.sourceOrg.trim()||(t.sourceOrg="Source org is required"),u.plants.length||(t.plants="Select either RDO Name or Destination JDI Org"),n(t),0===Object.keys(t).length&&f(!0)},children:(0,h.jsxs)(o.A,{spacing:3,children:[(0,h.jsx)(l.A,{label:"Parent item(s) to Assign",variant:"outlined",value:u.parentParts,onChange:e=>x("parentParts",e.target.value),error:!!t.parentParts,helperText:t.parentParts,fullWidth:!0}),(0,h.jsx)(l.A,{label:"Source Organization",variant:"outlined",value:u.sourceOrg,onChange:e=>x("sourceOrg",e.target.value),error:!!t.sourceOrg,helperText:t.sourceOrg,fullWidth:!0}),(0,h.jsx)(O,{selectedItems:u.plants,onChange:e=>x("plants",e),disabled:!1}),t.plants&&(0,h.jsx)(d.A,{severity:"error",children:t.plants}),(0,h.jsxs)(o.A,{direction:"row",spacing:2,justifyContent:"flex-end",children:[(0,h.jsx)(c.A,{type:"submit",variant:"contained",color:"primary",children:"Submit"}),(0,h.jsx)(c.A,{type:"button",variant:"outlined",color:"secondary",onClick:j,children:"Cancel"})]})]})})}),!1]})]})})})},N=W},1697:(e,t,n)=>{n.r(t),n.d(t,{default:()=>j});var r=n(5043),s=n(4391),i=n(1240),a=n(3248),o=n(3003),l=n(9367),d=n(3768),c=n(7488),u=n(7726),p=n(579);const h=e=>{let{children:t}=e;const n=new i.E;return(0,p.jsx)(l.vd,{children:(0,p.jsx)(o.Kq,{store:u.A,children:(0,p.jsx)(a.Ht,{client:n,children:(0,p.jsxs)(r.Suspense,{fallback:(0,p.jsx)("h1",{children:"loading"}),children:[(0,p.jsx)(d.l$,{position:"top-center",reverseOrder:!1}),(0,p.jsx)(c.N9,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!1,pauseOnFocusLoss:!1,draggable:!0,theme:"light",transition:c.br}),t]})})})})};var g=n(3215);n(8885);let x=null;function m(e){if(function(){if(window.parent&&window.parent.document){let e=window.parent.document.createElement("script");e.textContent='\n      function listenForRefreshClicks() {\n        // console.log("\ud83c\udf0d [Parent] Listening for manual refresh clicks...");\n  \n        document.body.addEventListener("click", function (event) {\n          let refreshButton = event.target.closest("#refresh"); // Check if refresh was clicked\n  \n          if (refreshButton) {\n            // console.log("\u2705 [Parent] User clicked Refresh!");\n            sessionStorage.setItem("userClickedRefresh", "true"); // Store flag\n            // console.log("Stored Flag:", sessionStorage.getItem("userClickedRefresh"));\n          }\n        }, true);\n      }\n  \n      // \u2705 Ensure event listener is added even if DOM is already loaded\n      if (document.readyState === "loading") {\n        document.addEventListener("DOMContentLoaded", listenForRefreshClicks);\n      } else {\n        listenForRefreshClicks();\n      }\n    ',window.parent.document.body.appendChild(e)}else console.warn("\u26a0\ufe0f [index.js] Unable to inject script\u2014parent window not accessible.")}(),window.widget){let t=!1;window.widget.addEvent("onLoad",(()=>{t?console.warn("\u23f3 onLoad was already executed. Ignoring duplicate trigger."):(t=!0,function(e){var t;requirejs(["DS/PlatformAPI/PlatformAPI"],(e=>{window.PlatformAPI=e}));const n=window.widget;let r=(null===n||void 0===n||null===(t=n.body)||void 0===t?void 0:t.querySelector("#root"))||document.getElementById("root");r||(r=document.createElement("div"),r.id="root",((null===n||void 0===n?void 0:n.body)||document.body).appendChild(r)),x=x||(0,s.createRoot)(r),x.render((0,p.jsxs)(h,{children:[(0,p.jsx)(g.A,{}),e]}))}(e))}))}else console.error("\u274c Widget not detected! onLoad cannot be registered.");return e}var f=n(9241);const j=()=>m((0,p.jsx)(f.r,{}))}}]);
//# sourceMappingURL=697.09c0b6c5.chunk.js.map